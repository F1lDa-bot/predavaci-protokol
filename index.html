<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generátor předávacího protokolu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for printing */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none;
            }
            #protocol-form {
                box-shadow: none;
                border: none;
                margin: 0;
                padding: 0;
            }
        }
        /* Styling for the dotted line inputs */
        .form-input {
            border: none;
            border-bottom: 1px dotted #333;
            background-color: transparent;
            padding: 2px 1px;
            outline: none;
            width: 100%;
        }
        .form-input:focus {
            border-bottom: 1px solid #000;
        }
        /* Custom checkbox */
        .custom-checkbox {
            appearance: none;
            -webkit-appearance: none;
            height: 1.25rem;
            width: 1.25rem;
            border: 1px solid #000;
            cursor: pointer;
            display: inline-block;
            position: relative;
            top: 4px;
        }
        .custom-checkbox:checked {
            background-color: #000;
        }
        .custom-checkbox:checked::after {
            content: '✓';
            font-size: 1rem;
            color: white;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        .custom-checkbox.checked-x:checked::after {
            content: 'X';
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <!-- The form that will be converted to PDF -->
        <div id="protocol-form" class="bg-white p-6 sm:p-10 md:p-16 border border-gray-200 shadow-lg">
            <header class="text-center mb-12">
                <!-- Logo SVG -->
                <svg viewBox="0 0 200 40" class="h-16 mx-auto mb-2" alt="Brands Logo">
                    <path d="M56.8,32.2c-2.7,2.2-6.1,3.4-9.6,3.4c-4.4,0-8.3-1.8-11.2-4.9c-2.9-3.1-4.4-7.2-4.4-12.1c0-4.9,1.5-9,4.4-12.1 c2.9-3.1,6.8-4.9,11.2-4.9c3.5,0,6.9,1.2,9.6,3.4l-2.4,4.5c-2-1.6-4.4-2.5-7.2-2.5c-2.9,0-5.4,1-7.4,3.1c-2,2-3,4.8-3,8.1 c0,3.3,1,6,3,8.1c2,2,4.5,3.1,7.4,3.1c2.8,0,5.2-0.8,7.2-2.5L56.8,32.2z" transform="translate(60)"></path>
                    <text x="120" y="30" font-family="Inter, sans-serif" font-weight="bold" font-size="28" letter-spacing="-1">BRANDS.</text>
                    <path d="M2.9,13.2c-0.8,2.8-1.2,5.8-1.2,8.9c0,3.2,0.4,6.2,1.2,8.9l5.1-1.8c-0.6-2.2-0.9-4.5-0.9-6.9c0-2.5,0.3-4.9,0.9-7.1 L2.9,13.2z" fill="#D946EF"></path>
                    <path d="M12.6,33.5c2.3,1.1,4.8,1.7,7.5,1.7c2.1,0,4-0.4,5.9-1.1l2,4.7c-2.5,1-5.3,1.5-8.1,1.5c-3.4,0-6.7-0.7-9.7-2.1 L12.6,33.5z" fill="#D946EF"></path>
                    <path d="M8,8.2L12.6,3.7C15.6,2,18.9,1.3,22.3,1.3c2.7,0,5.4,0.5,7.9,1.5l2-4.7C29.4-0.8,25.9-1.3,22.3-1.3 C18.5-1.3,15-0.5,11.8,1L8,8.2z" fill="#D946EF"></path>
                </svg>
                <p class="text-xl sm:text-2xl text-gray-600 tracking-wider">Smarty.cz | iWant.cz | JRC.cz | Brloh.sk</p>
            </header>

            <main>
                <h1 class="text-2xl font-bold text-center mb-8">Předání zařízení:</h1>

                <!-- Customer Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 mb-6">
                    <div class="flex items-center">
                        <label for="customer" class="font-bold whitespace-nowrap mr-2">Zákazník:</label>
                        <input type="text" id="customer" class="form-input">
                    </div>
                    <div class="flex items-center">
                        <label for="phone" class="font-bold whitespace-nowrap mr-2">Telefon:</label>
                        <input type="text" id="phone" class="form-input">
                    </div>
                    <div class="flex items-center">
                        <label for="ico" class="font-bold whitespace-nowrap mr-2">IČO:</label>
                        <input type="text" id="ico" class="form-input">
                    </div>
                </div>

                <!-- Device Info -->
                <div class="mb-6">
                    <div class="flex flex-wrap items-center gap-x-6 gap-y-2 mb-4">
                        <p class="font-bold">Zařízení:</p>
                        <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox checked-x"> iPhone</label>
                        <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> iPad/Watch</label>
                        <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> Mac/PC</label>
                        <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> Konzole</label>
                        <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> ACC/jiné</label>
                    </div>
                     <div class="flex items-center mb-4">
                        <label for="sn" class="font-bold whitespace-nowrap mr-2">SN:</label>
                        <input type="text" id="sn" class="form-input">
                    </div>
                     <div class="flex items-center">
                        <label for="condition" class="font-bold whitespace-nowrap mr-2">Stav zařízení:</label>
                        <input type="text" id="condition" class="form-input">
                    </div>
                </div>
                
                <!-- Requested Service -->
                <div class="mb-10">
                     <div class="flex flex-wrap items-center gap-x-8 gap-y-4">
                        <p class="font-bold w-full md:w-auto">Požadovaná služba:</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-4 flex-1">
                            <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox checked-x"> Diagnostika/čištění</label>
                            <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> Reinstalace/záloha/přehrání dat</label>
                            <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox checked-x"> Ekologická likvidace</label>
                            <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="custom-checkbox"> Cenový návrh pro pojišťovnu</label>
                        </div>
                    </div>
                </div>

                <!-- Location, Date, Price -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-x-12 gap-y-6 mb-16">
                    <div class="flex items-center">
                        <label for="location" class="font-bold whitespace-nowrap mr-2">V:</label>
                        <input type="text" id="location" class="form-input">
                    </div>
                    <div class="flex items-center">
                        <label for="date" class="font-bold whitespace-nowrap mr-2">Dne:</label>
                        <input type="text" id="date" class="form-input">
                    </div>
                    <div class="flex items-center">
                        <label for="price" class="font-bold whitespace-nowrap mr-2">Cena:</label>
                        <input type="text" id="price" class="form-input">
                    </div>
                </div>

                <!-- Signature Lines -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-16 gap-y-8 mt-16 pt-8">
                     <div class="text-center">
                         <div class="border-b-2 border-black w-full"></div>
                         <p class="text-sm mt-2">Zákazník (hůlkovým písmem + podpis)</p>
                     </div>
                     <div class="text-center">
                         <div class="border-b-2 border-black w-full"></div>
                         <p class="text-sm mt-2">za Smarty Brands. (razítko + podpis)</p>
                     </div>
                </div>

            </main>

            <!-- Footer Icons -->
            <footer class="mt-20 pt-8 flex justify-center items-center gap-4 sm:gap-8 flex-wrap">
                <!-- PS4 -->
                <svg xmlns="http://www.w3.org/2000/svg" width="128" height="64" viewBox="0 0 128 64" class="h-10 text-gray-600"><path fill="currentColor" d="M124 35.89h-3.45a2.15 2.15 0 0 1-2.15-2.15V22.25a2.15 2.15 0 0 1 2.15-2.15H124a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4H4a4 4 0 0 0-4 4v12.1a4 4 0 0 0 4 4h94.4a2.15 2.15 0 0 1 2.15 2.15v11.49a2.15 2.15 0 0 1-2.15 2.15H4a4 4 0 0 0-4 4v12.1a4 4 0 0 0 4 4h120a4 4 0 0 0 4-4v-12.1a4 4 0 0 0-4-4M100.55 7.84H4V4h96.55Zm19.9 25.9a2.15 2.15 0 0 1 2.15 2.15H102.7a4.3 4.3 0 0 0-4.3-4.3H4v-3.8h96.55a2.15 2.15 0 0 1 2.15 2.15Zm-19.9 22.3H4v-3.85h116.45a4.3 4.3 0 0 0 4.3-4.3v-1.8a2.15 2.15 0 0 1-2.15 2.15H100.55Z"></path></svg>
                <!-- Xbox -->
                <svg xmlns="http://www.w3.org/2000/svg" width="128" height="64" viewBox="0 0 24 24" class="h-14 text-gray-600"><path fill="currentColor" d="M22 6H2V4h20v2M2.28 8l1.35 9.3A1 1 0 0 0 4.62 18H7v3H5v2h6v-2H9v-3h6v3h-2v2h6v-2h-2v-3h2.38a1 1 0 0 0 .99-.7l1.35-9.3H2.28m4.22 8l-.6-4h12.2l-.6 4H6.5Z"></path></svg>
                <!-- Controller 1 -->
                <svg xmlns="http://www.w3.org/2000/svg" width="128" height="64" viewBox="0 0 24 24" class="h-12 text-gray-600"><path fill="currentColor" d="M12 2a10 10 0 0 0-9.2 13.58a7.84 7.84 0 0 0-1.2-1.84a1 1 0 1 0-1.2 1.6C2 17.27 3.55 18 5.43 18H7v-2H5.43c-1.12 0-2.11-.42-2.8-1.15C3.3 14.2 3.8 15 4 15.31V15a1 1 0 0 0 1 1h2v-2H6a1 1 0 0 0-1 1v.37c.22-.19.46-.35.71-.51C6 14.7 7 14.33 8 15h1v-2H8c-1.33 0-2.22.8-2.55 1.88a10 10 0 0 0 12.83-6.18A1 1 0 0 0 17.5 10h-3a1 1 0 0 0-1 1v1h-2v-1a1 1 0 0 0-1-1h-2v2h1a1 1 0 0 0 1-1v-.5c0-.17.06-.33.16-.45C10.77 10.42 12 8.43 12 6a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v3.37C2 10.13 2 11.07 2 12s0 .87 0 1.63V15.5c0 .28 0 .55.07.82c.1.34.25.67.43.98H2v2h2.57c.7 2 2.11 3.5 4 4.43V22h2.86v-2H10v-1h4v1h-1.14v2H16v-2.07c1.88-.93 3.3-2.43 4-4.43H22v-2h-.5c.18-.31.33-.64.43-.98C22 13.55 22 13.28 22 13v-.5c0-.82-.2-1.58-.57-2.22A10 10 0 0 0 12 2m0 2c3.48 0 6.53 1.9 8.1 4.67c-1.14.47-2.12 1.25-2.8 2.23H15v1h-2v-1h-.5c-1.28 0-2.44.53-3.25 1.34A6 6 0 0 1 4 6c0-2.21 1.79-4 4-4h4m-6 6h1.5a.5.5 0 0 1 .5.5v1h-2v-1a.5.5 0 0 1 .5-.5m3 0h2v1h-2v-1m4.5-.5a.5.5 0 0 1 .5.5v1h-2v-1a.5.5 0 0 1 .5-.5H15Z"></path></svg>
                <!-- Controller 2 -->
                <svg xmlns="http://www.w3.org/2000/svg" width="128" height="64" viewBox="0 0 24 24" class="h-12 text-gray-600"><path fill="currentColor" d="M16.5 8c-.53 0-1.04.11-1.5.32V5H13v3.32c-.46-.21-.97-.32-1.5-.32s-1.04.11-1.5.32V5H8v3.32c-.46-.21-.97-.32-1.5-.32C4.01 8 2 10.01 2 12.5V13h20v-.5C22 10.01 19.99 8 16.5 8M9 18v3h6v-3h-6Z"></path><path fill="currentColor" d="M22.5 14H18v3h-2v-3h-8v3H6v-3H1.5c-.83 0-1.5.67-1.5 1.5V20c0 .83.67 1.5 1.5 1.5h21c.83 0 1.5-.67 1.5-1.5v-4.5c0-.83-.67-1.5-1.5-1.5"></path></svg>
                <!-- Handheld -->
                <svg xmlns="http://www.w3.org/2000/svg" width="128" height="64" viewBox="0 0 24 24" class="h-10 text-gray-600"><path fill="currentColor" d="M21 4H3a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2m-13 3h2v2h-2v2h2v2H8v-2H6V9h2V7m4 0h2v2h-2V7m2 3h2v2h-2v-2m-2 3h2v2h-2v-2m-4 1h2v2H8v-2m10 1c-.55 0-1-.45-1-1s.45-1 1-1s1 .45 1 1s-.45 1-1 1m0-3c-.55 0-1-.45-1-1s.45-1 1-1s1 .45 1 1s-.45 1-1 1Z"></path></svg>
            </footer>

        </div>

        <!-- Action Button -->
        <div class="text-center mt-8 no-print">
            <button id="generate-pdf" class="bg-fuchsia-500 hover:bg-fuchsia-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-transform transform hover:scale-105">
                Vygenerovat PDF
            </button>
        </div>
    </div>

    <script>
        // Set current date
        document.addEventListener('DOMContentLoaded', function() {
            const dateInput = document.getElementById('date');
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0');
            const month = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
            const year = today.getFullYear();
            dateInput.value = `${day}.${month}.${year}`;
        });

        // PDF Generation logic
        document.getElementById('generate-pdf').addEventListener('click', () => {
            const protocolForm = document.getElementById('protocol-form');
            const button = document.getElementById('generate-pdf');
            
            // Hide button to not include it in the PDF
            button.style.display = 'none';

            // Use html2canvas to capture the form element
            html2canvas(protocolForm, {
                scale: 2, // Higher scale for better quality
                useCORS: true,
                logging: false,
                windowWidth: protocolForm.scrollWidth,
                windowHeight: protocolForm.scrollHeight
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;

                // A4 dimensions in mm
                const pdfWidth = 210;
                const pdfHeight = 297;

                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const canvasAspectRatio = canvasWidth / canvasHeight;

                let imgWidth = pdfWidth - 20; // with margin
                let imgHeight = imgWidth / canvasAspectRatio;
                
                let pdf;
                // Check if content is taller than A4, then create a longer PDF
                if (imgHeight > (pdfHeight - 20)) {
                    pdf = new jsPDF({
                        orientation: 'p',
                        unit: 'mm',
                        format: [pdfWidth, imgHeight + 20] // custom height
                    });
                } else {
                     pdf = new jsPDF({
                        orientation: 'p',
                        unit: 'mm',
                        format: 'a4'
                    });
                }
                
                const x = (pdf.internal.pageSize.getWidth() - imgWidth) / 2;
                const y = 10; // top margin

                pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
                pdf.save('predavaci-protokol.pdf');

                // Show button again
                button.style.display = 'block';
            }).catch(err => {
                console.error("Error generating PDF:", err);
                // Show button again in case of error
                button.style.display = 'block';
            });
        });
    </script>

</body>
</html>
